# relater

<!-- badges: start -->
<!-- badges: end -->

R package for parsing output files generated by Relate, as well as simple manipulations of them, including an implementation of the polygenic selection test.

## Installation

You can install the released version of relater from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("relater")
```

## Example

``` r
library(relater)
# Example analysis:

# read files
mut         <- read.mut("./inst/extdata/example.mut.gz", CHR = 1)
sele        <- read.sele("./inst/extdata/example.sele.gz", CHR = 1)
freq        <- read.freq("./inst/extdata/example.freq.gz", CHR = 1)
qual        <- read.qual("./inst/extdata/example.qual.gz", CHR = 1)

# Obtain allele_ages data table
allele_ages <- get.allele_ages(mut, freq, sele)
allele_ages <- Filter(allele_ages, qual)

######### Polygenic selection test #########

# Initialise
quant       <- PolyTest_Init(allele_ages)

# Make a fake polygenic trait
df          <- allele_ages[!is.na(allele_ages$pvalue),]
df          <- df[df$pvalue < 0,]
df          <- df[sample(1:nrow(df), 50, replace = F),]

# Run polygenic test
PolyTest(df$DAF, df$pvalue, quant$quantiles, quant$allele_ages_quantiles)
```
